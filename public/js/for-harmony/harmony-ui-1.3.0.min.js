window.Harmony||(window.Harmony={});
Harmony.UI=window.Harmony.UI={LOADING:"loading",OUTPUT:"output",_fields:[],addField:function(a,c){null!=c&&(Harmony.UI._fields[a]=c.length?c[0]:c)},addressLookup:function(a,c,b){Harmony.UI.addField(Harmony.ADDRESS,a);Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c),k={fullAddress:Harmony.UI._getFieldValue(Harmony.ADDRESS)};Harmony.UI._setLoading(Harmony.ADDRESS,!0);Harmony.address(k,f,function(a){for(var d=[],c,g=0;g<a.payload.length;g++)c=
a.payload[g],c.label=c.fullAddress,c.value=c.fullAddress,d[d.length]=c;b(d);Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},b.select=function(b,h){a.value=h.item.value;Harmony.transaction(c,function(){Harmony.UI._setFieldValues(h.item)})},Harmony.UI._autocomplete(a,b))},buildingNameLookup:function(a,c,b){Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},Harmony.UI.addField(Harmony.BUILDING_NAME,a),b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.BUILDING_NAME,
!0);Harmony.buildingName(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.buildingName+", "+d.streetNumber+" "+d.street+("undefined"!==typeof d.locality?", "+d.locality:"")+("undefined"!==typeof d.suburb?", "+d.suburb:"")+("undefined"!==typeof d.townCity?", "+d.townCity:""),d.value=d.buildingName,c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.BUILDING_NAME,!1)})},b.select=function(b,c){a.value=c.item.value;c.item.subdwelling="";Harmony.UI._setFieldValues(c.item)},
Harmony.UI._autocomplete(a,b))},floorLevelTypeSelect:function(a,c){var b=Harmony.UI._getSourceOfTruth(c);Harmony.Types.floorLevel(b,function(b){Harmony.UI._populateSelect(a,b)})},localityLookup:function(a,c,b){Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},Harmony.UI.addField(Harmony.LOCALITY,a),b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.LOCALITY,!0);Harmony.locality(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=
a.payload[e],d.label=d.locality+" ("+d.postcode+" "+("undefined"!=typeof d.townCity?d.townCity:d.state)+")",d.value=d.locality,c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.LOCALITY,!1)})},b.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValue(Harmony.POSTCODE,c.item.postcode)},Harmony.UI._autocomplete(a,b))},parseAddress:function(){Harmony.UI._setLoading(Harmony.ADDRESS,!0);Harmony.Parse.address(Harmony.UI._getFieldValue(Harmony.ADDRESS),function(a){a.status==Harmony.SUCCESS?null==
a.payload[0].exception?(Harmony.UI._clearOutput(),Harmony.UI._setFieldValues(a.payload[0])):(Harmony.UI._clearFieldValues(),Harmony.UI._error(a.payload[0].exception)):Harmony.UI._error(a.message);Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},postalLookup:function(a,c,b){Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},Harmony.UI.addField(Harmony.POSTAL,a),b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.POSTAL,!0);Harmony.postal(Harmony.UI._getAddress(f),
f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.postal,d.value=d.postal,c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.POSTAL,!1)})},b.select=function(c,b){a.value=b.item.value;Harmony.UI._setFieldValues(b.item)},Harmony.UI._autocomplete(a,b))},postalTypeSelect:function(a,c){var b=Harmony.UI._getSourceOfTruth(c);Harmony.Types.postal(b,function(b){Harmony.UI._populateSelect(a,b)})},postcodeLookup:function(a,c,b){Harmony.UI.addField(Harmony.POSTCODE,a);Harmony.UI._checkDependencies()&&
(b="undefined"!=typeof b?b:{},b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.POSTCODE,!0);Harmony.postcode(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e,f=0;f<a.payload.length;f++)d=a.payload[f],e="undefined"!=typeof d.suburb?d.suburb:"undefined"!=typeof d.locality?d.locality:"",e+=(""!=e?" ":"")+("undefined"!=typeof d.townCity?d.townCity:"undefined"!=typeof d.state?d.state:""),d.label=d.postcode+" ("+e+")",d.value=d.postcode,c[c.length]=d;b(c);
Harmony.UI._setLoading(Harmony.POSTCODE,!1)})},b.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,b))},setOutputElement:function(a){Harmony.UI.addField(Harmony.UI.OUTPUT,a)},streetLookup:function(a,c,b){Harmony.UI.addField(Harmony.STREET,a);Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.STREET,!0);Harmony.street(Harmony.UI._getAddress(f),
f,function(a){for(var c=[],d=0;d<a.payload.length;d++){var e=a.payload[d];e.label=e.street+", "+("undefined"!=typeof e.suburb?e.suburb:e.locality);e.value=e.street;c[c.length]=e}b(c);Harmony.UI._setLoading(Harmony.STREET,!1)})},b.select=function(c,b){a.value=b.item.value;Harmony.UI._setFieldValues(b.item)},Harmony.UI._autocomplete(a,b))},streetNumberLookup:function(a,c,b){Harmony.UI.addField(Harmony.STREET_NUMBER,a);Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},b.source=function(a,
b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.STREET_NUMBER,!0);Harmony.streetNumber(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.streetNumber+" "+d.street,d.value=$.trim(d.streetNumber),c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.STREET_NUMBER,!1)})},b.select=function(c,b){a.value=b.item.value;b.item.subdwelling="";Harmony.UI._setFieldValues(b.item)},Harmony.UI._autocomplete(a,b))},streetSuffixTypeSelect:function(a,
c){var b=Harmony.UI._getSourceOfTruth(c);Harmony.Types.streetSuffix(b,function(b){Harmony.UI._populateSelect(a,b)})},streetTypeSelect:function(a,c){var b=Harmony.UI._getSourceOfTruth(c);Harmony.Types.street(b,function(b){Harmony.UI._populateSelect(a,b)})},subdwellingLookup:function(a,c,b){Harmony.UI.addField(Harmony.SUBDWELLING,a);Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.SUBDWELLING,!0);
Harmony.subdwelling(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.fullAddress,d.value=$.trim(d.subdwelling),c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.SUBDWELLING,!1)})},b.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,b))},suburbLookup:function(a,c,b){Harmony.UI.addField(Harmony.SUBURB,a);Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},b.source=function(a,b){var f=
Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.SUBURB,!0);Harmony.suburb(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.suburb+", "+d.townCity+" ("+d.postcode+")",d.value=d.suburb,c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.SUBURB,!1)})},b.select=function(c,b){a.value=b.item.value;Harmony.UI._setFieldValues(b.item)},Harmony.UI._autocomplete(a,b))},townCityLookup:function(a,c,b){Harmony.UI.addField(Harmony.TOWN_CITY,
a);Harmony.UI._checkDependencies()&&(b="undefined"!=typeof b?b:{},b.source=function(a,b){var f=Harmony.UI._getSourceOfTruth(c);Harmony.UI._setLoading(Harmony.TOWN_CITY,!0);Harmony.townCity(Harmony.UI._getAddress(f),f,function(a){for(var c=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.townCity+" ("+(""!=d.suburb?d.suburb+", ":"")+d.postcode+")",d.value=d.townCity,c[c.length]=d;b(c);Harmony.UI._setLoading(Harmony.TOWN_CITY,!1)})},b.select=function(c,b){a.value=b.item.value;Harmony.UI._setFieldValues(b.item)},
Harmony.UI._autocomplete(a,b))},unitFlatTypeSelect:function(a,c){var b=Harmony.UI._getSourceOfTruth(c);Harmony.Types.unitFlat(b,function(b){Harmony.UI._populateSelect(a,b)})},identifyAddress:function(){Harmony.UI._setLoading(Harmony.EID,!0);Harmony.Extensions.identify({eid:Harmony.UI._getFieldValue(Harmony.EID)},function(a){null!=a?Harmony.UI._setFieldValues(a.payload[0]):Harmony.UI._error("Failed to identify address");Harmony.UI._setLoading(Harmony.EID,!1)})},_addSelectOption:function(a,c,b){var g=
document.createElement("option");g.text=c;g.value=b;a.add(g)},_autocomplete:function(a,c){window.$(a).autocomplete(c)},_checkDependencies:function(){var a=!0;window.Harmony||(alert("Harmony JavaScript library is required"),a=!1);window.jQuery||(alert("jQuery is required"),a=!1);"undefined"!=typeof jQuery.autocomplete&&(alert("jQuery UI Autocomplete is required"),a=!1);return a},_clearFieldValues:function(){Harmony.UI._setFieldValues({})},_clearOutput:function(){Harmony.UI._error("")},_error:function(a){var c=
Harmony.UI._getField(Harmony.UI.OUTPUT);null!=c&&("undefined"!=typeof c.value?c.value=a:$(c).html(a))},_getAddress:function(a){a=Harmony.UI._getSourceOfTruthCountry(a);var c={};null!=Harmony.UI._getField(Harmony.POSTCODE)&&(c.postcode=Harmony.UI._getFieldValue(Harmony.POSTCODE));a==Harmony.AUSTRALIA&&null!=Harmony.UI._getField(Harmony.LOCALITY)&&(c.locality=Harmony.UI._getFieldValue(Harmony.LOCALITY));a==Harmony.NEW_ZEALAND&&null!=Harmony.UI._getField(Harmony.TOWN_CITY)&&(c.townCity=Harmony.UI._getFieldValue(Harmony.TOWN_CITY));
a==Harmony.NEW_ZEALAND&&null!=Harmony.UI._getField(Harmony.SUBURB)&&(c.suburb=Harmony.UI._getFieldValue(Harmony.SUBURB));null!=Harmony.UI._getField(Harmony.STREET)&&(c.street=Harmony.UI._getFieldValue(Harmony.STREET));null!=Harmony.UI._getField(Harmony.STREET_NUMBER)&&(c.streetNumber=Harmony.UI._getFieldValue(Harmony.STREET_NUMBER));null!=Harmony.UI._getField(Harmony.SUBDWELLING)&&(c.subdwelling=Harmony.UI._getFieldValue(Harmony.SUBDWELLING));null!=Harmony.UI._getField(Harmony.POSTAL)&&(c.postal=
Harmony.UI._getFieldValue(Harmony.POSTAL));null!=Harmony.UI._getField(Harmony.BUILDING_NAME)&&(c.buildingName=Harmony.UI._getFieldValue(Harmony.BUILDING_NAME));return c},_getField:function(a){return Harmony.UI._fields[a]},_getFieldValue:function(a){a=$(Harmony.UI._getField(a));var c="";a.length&&(c=a.val());return c},_getSourceOfTruth:function(a){var c=Harmony.UI._getFieldValue(Harmony.SOURCE_OF_TRUTH);if("undefined"==typeof c||""==c)c=a;return c},_getSourceOfTruthCountry:function(a){var c=null;a==
Harmony.AUSOTS||a==Harmony.AUPAF||a==Harmony.GNAF?c=Harmony.AUSTRALIA:a==Harmony.NZPAF&&(c=Harmony.NEW_ZEALAND);return c},_populateSelect:function(a,c){var b;if("undefined"!=typeof c&&"undefined"!=typeof c.payload)for(b=0;b<c.payload.length;b++)Harmony.UI._addSelectOption(a,c.payload[b].name,c.payload[b].value);else Harmony.UI._addSelectOption(a,"No data available",0)},_setFieldValue:function(a,c){var b=Harmony.UI._getField(a);null!=b&&(b.value="undefined"!=typeof c?c:"")},_setFieldValues:function(a){var c=
"";if("undefined"!=typeof a){Harmony.UI._setFieldValue(Harmony.EID,a.eid);Harmony.UI._setFieldValue(Harmony.POSTCODE,a.postcode);Harmony.UI._setFieldValue(Harmony.STATE,a.state);Harmony.UI._setFieldValue(Harmony.LOCALITY,a.locality);Harmony.UI._setFieldValue(Harmony.TOWN_CITY,a.townCity);Harmony.UI._setFieldValue(Harmony.SUBURB,a.suburb);Harmony.UI._setFieldValue(Harmony.STREET,a.street);Harmony.UI._setFieldValue(Harmony.STREET_2,a.street2);Harmony.UI._setFieldValue(Harmony.STREET_NUMBER,a.streetNumber);
Harmony.UI._setFieldValue(Harmony.POSTAL,a.postal);Harmony.UI._setFieldValue(Harmony.BUILDING_NAME,a.buildingName);Harmony.UI._setFieldValue(Harmony.SUBDWELLING,a.subdwelling);Harmony.UI._setFieldValue(Harmony.CARE_OF,a.careOf);Harmony.UI._setFieldValue(Harmony.ADDRESS,a.fullAddress);Harmony.UI._setFieldValue(Harmony.ID,a.id);Harmony.UI._setFieldValue(Harmony.FLOOR_LEVEL_TYPE,a.floorLevelType);Harmony.UI._setFieldValue(Harmony.FLOOR_LEVEL_NUMBER,a.floorLevelNumber);Harmony.UI._setFieldValue(Harmony.FLAT_UNIT_TYPE,
a.flatUnitType);Harmony.UI._setFieldValue(Harmony.FLAT_UNIT_NUMBER,a.flatUnitNumber);Harmony.UI._setFieldValue(Harmony.LOT_NUMBER,a.lotNumber);Harmony.UI._setFieldValue(Harmony.STREET_NAME,a.streetName);Harmony.UI._setFieldValue(Harmony.STREET_TYPE,a.streetType);Harmony.UI._setFieldValue(Harmony.STREET_SUFFIX,a.streetSuffix);for(var b in a.attributes)c+=(""==c?"":", ")+b+": "+a.attributes[b];Harmony.UI._setFieldValue(Harmony.ATTRIBUTES,c)}},_setLoading:function(a,c){var b=$(Harmony.UI._getField(a));
c?b.addClass(Harmony.UI.LOADING):b.removeClass(Harmony.UI.LOADING)}};